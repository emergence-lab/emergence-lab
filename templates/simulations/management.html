{% extends "core/base.html" %}


{% block content %}

<h2 class="text-center">Simulation Management Console</h2>

<div class="col-md-2">
    <ul class="nav nav-pills nav-stacked">
    <li role="presentation" {% if request.path == '/simulations/' %}class="active"{% endif %}><a href="{% url 'simulation_incomplete' %}">Incomplete</a></li>
    <li role="presentation" {% if request.path == '/simulations/completed/' %}class="active"{% endif %}><a href="{% url 'simulation_complete' %}">Completed</a></li>
    <li role="presentation" {% if request.path == '/simulations/all/' %}class="active"{% endif %}><a href="{% url 'simulation_all' %}">All</a></li>
    </ul>
</div>

<br>
<div class="col-md-8 text-center">
  <h3>Execution Nodes <a class="glyphicon glyphicon-refresh" href="{% url 'simulation_incomplete' %}"></a></h3>
  <p></p>

  <p></p>
</div>
</br>

<div class="col-md-8 text-center">
  <table class="table">      
    <tr>
      <td><strong>Instance Name</strong></td>
      <td><strong>Type</strong></td>
      <td><strong>State</strong></td>
      <td><strong>Uptime</strong></td>
      {% if user.is_staff %}
          <td><strong>Actions</strong></td>
      {% endif %}
    </tr>
    {% for instance in instances %}
      <tr>
        <td>{{ instance.instance_name }}</td>
        <td>{{ instance.instance_type }}</td>
        <td>
        {% if instance.instance_state == 'stopped' %}
        <a><span class="label label-danger">OFFLINE</span></a>
        {% elif instance.instance_state == 'running' %}
        <a><span class="label label-success">RUNNING</span></a>
        {% elif instance.instance_state %}
        <a><span class="label label-primary">CHANGING</span></a>  
        {% endif %}
        </td>
        <td>
            {% if instance.instance_state == 'running' %}
            {{ instance.instance_uptime }}</td>
            {% endif %}
        {% if user.is_staff %}
            <td>
            {% if instance.instance_state == 'stopped' %}
            <a class="glyphicon glyphicon-off" href="{% url 'start_instance' instance.instance_name %}"></a>
            {% elif instance.instance_state == 'running' %}
            <a class="glyphicon glyphicon-off" href="{% url 'stop_instance' instance.instance_name %}">/a>
            {% endif %}
            </td>
        {% endif %}
      </tr>
    {% endfor %}
  </table>
</div>

<br></br>

<div class="col-md-8 col-md-offset-2">
  <h3 class="text-center">Jobs</h3>
</div>

<br></br>


  
<div class="col-md-8 col-md-offset-2 text-center">
  <table class="table">      
    <tr>
        <td><strong>Status</strong></td>
        <td><strong>Job ID</strong></td>
        <td><strong>User</strong></td>
        <td><strong>Request Date</strong></td>
        <td><strong>Node Type</strong></td>
        <td><strong>Priority</strong></td>
        <td><strong>Actions</strong></td>
    </tr>
    {% for items in object_list %}
      <tr>
          <td>{% if items.finish_date %}<span class="glyphicon glyphicon-ok"></span>{% endif %}</td>
          <td>{{ items.id }}</td>
          <td>{{ items.user.full_name }}</td>
          <td>{{ items.request_date }}</td>
          <td>{{ items.execution_node }}</td>
          <td>{% if items.priority %}<span class="glyphicon glyphicon-flag"></span>{% endif %}</td>
          <td>
          {% if request.user == items.user %}    
              {% if items.finish_date %}<a class="glyphicon glyphicon-download-alt" href="#"></a>></a>
              {% else %}<a class="glyphicon glyphicon-edit" href={% url 'simulation_edit' pk=items.id %}></a>
              <a class="glyphicon glyphicon-remove" href="{% url 'simulation_cancel' pk=items.id %}"></a>{% endif %}
          {% elif user.is_staff %}
              {% if items.finish_date %}<a class="glyphicon glyphicon-download-alt" href="#"></a>
              {% else %}<a class="glyphicon glyphicon-edit" href={% url 'simulation_edit' pk=items.id %}></a>
              <a class="glyphicon glyphicon-remove" href="{% url 'simulation_cancel' pk=items.id %}"></a>{% endif %}
          {% endif %}
          </td>
      </tr>
    {% endfor %}
    <tr>
        <td></td><td></td><td></td><td></td><td></td><td></td>
        <td><a class="glyphicon glyphicon-plus" href="{% url 'create_form' %}"></a></td>
    </tr>
  </table>

</div>    

<div class="col-md-8 col-md-offset-2 text-center">
    {% if is_paginated %}
    <nav>
      <ul class="pagination">
        {% if page_obj.has_previous %}
        <li><a href="?page={{ page_obj.previous_page_number }}">{% if not page_obj.has_previous %}<span aria-hidden="true">{% endif %}&laquo; Previous</span><span class="sr-only">Previous</span></a></li>
        {% endif %}
        {% if page_obj.has_next %}
        <li><a href="?page={{ page_obj.next_page_number }}">{% if not page_obj.has_next %}<span aria-hidden="true">{% endif %}Next &raquo;</span><span class="sr-only">Next</span></a></li>
        {% endif %}
      </ul>
    </nav>
    {% endif %}
</div>

{% endblock %}



