{% extends 'project_management/pm_base.html' %}

{% block subtitle %}{{milestone.name}}{% endblock %}

{% block pm_content %}

{% if milestone.user == request.user %}

<div class="col-md-12">
  <div>
    {% if milestone.is_active %}
    <a href="{% url 'milestone_close' milestone.slug %}" class="btn btn-danger">Close Milestone</a>
    {% else %}
    <a href="{% url 'milestone_open' milestone.slug %}" class="btn btn-success">Re-Open Milestone</a>
    {% endif %}
  </div>
  <div class="spacer-xs"></div>
  <div class="panel {% if milestone.is_active and milestone.due_date < today.date %}panel-warning{%else%}panel-info{%endif%}">
    <div class="panel-heading">
      {% if milestone.is_active and milestone.due_date < today.date %}<strong>Expired</strong>{%else%}Description{%endif%}
      <span class="pull-right"><span class="glyphicon glyphicon-time"></span> {{milestone.due_date}}</span>
    </div>
    <div class="panel-body">
      {{milestone.description}}
    </div>
  </div>
</div>
<div class="col-md-6">
  <div>
    <h4>Processes</h4>
  </div>
  <div class="list-group">
    {% for process in milestone.processes.all reversed %}
      <a class="list-group-item" href="#">
        <h4 class="list-group-item-heading">{{process.created}}</h4>
        <p class="list-group-item-text">
          {{process.type}}
        </p>
        <p class="list-group-item-text">
          {{process.uuid}} {% if process.legacy_identifier %}({{process.legacy_identifier}}){% endif %}
        </p>
      </a>

    {% endfor %}
  </div>
</div>
<div class="col-md-6">
  <div>
    <h4>Literature</h4>
  </div>
  <div class="list-group">
    {% for update in milestone.literature.all reversed %}
      <a class="list-group-item" href="#">
        <h4 class="list-group-item-heading">{{update.title}}</h4>
        <p class="list-group-item-text">
          {{update.created}}
        </p>
        <p class="list-group-item-text">
          {{update.doi}}
        </p>
      </a>

    {% endfor %}
  </div>
</div>
{% endif %}
{% endblock %}
